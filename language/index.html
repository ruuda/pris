
<!DOCTYPE html>
<html>
<head>
  <!--
    Kilsbergen MkDocs theme copyright 2019 Ruud van Asseldonk.
    Licensed under the Apache 2.0 license.
    See https://github.com/ruuda/kilsbergen.
  -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>The language — Pris</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500" rel="stylesheet">
  <style>
  /* The Inter font family, see https://rsms.me/inter.
     https://rsms.me/inter/#faq-cdn suggests that linking these files directly is fine.
  */
  @font-face {
    font-family: Inter;
    font-style:  normal;
    font-weight: 400;
    src: url("https://rsms.me/inter/font-files/Inter-Regular.woff2?v=3.11") format("woff2"),
         url("https://rsms.me/inter/font-files/Inter-Regular.woff?v=3.11") format("woff");
  }
  @font-face {
    font-family: Inter;
    font-style:  italic;
    font-weight: 400;
    src: url("https://rsms.me/inter/font-files/Inter-Italic.woff2?v=3.11") format("woff2"),
         url("https://rsms.me/inter/font-files/Inter-Italic.woff?v=3.11") format("woff");
  }
  @font-face {
    font-family: Inter;
    font-style:  normal;
    font-weight: 500;
    src: url("https://rsms.me/inter/font-files/Inter-Medium.woff2?v=3.11") format("woff2"),
         url("https://rsms.me/inter/font-files/Inter-Medium.woff?v=3.11") format("woff");
  }
  @font-face {
    font-family: Inter;
    font-style:  normal;
    font-weight: 600;
    src: url("https://rsms.me/inter/font-files/Inter-SemiBold.woff2?v=3.11") format("woff2"),
         url("https://rsms.me/inter/font-files/Inter-SemiBold.woff?v=3.11") format("woff");
  }
  @font-face {
    font-family: Inter;
    font-style:  normal;
    font-weight: 700;
    src: url("https://rsms.me/inter/font-files/Inter-Bold.woff2?v=3.11") format("woff2"),
         url("https://rsms.me/inter/font-files/Inter-Bold.woff?v=3.11") format("woff");
  }
  /* Modular scale with exponent 1.7^(1/3). The 1.7 was chosen as the line hight
     that goes well with Inter. Previously I used 1.59, but it was just too tight.
     0.59em
     0.70em
     1.00em
     1.19em
     1.42em
     1.70em
     2.02em
     2.42em
  */
  * { margin: 0; padding: 0; border-spacing: 0; }
  html {
    font-family: Inter, Roboto, sans-serif;
    /*
    Turn on character variant 8 for Inter, which puts serifs on the uppercase I.
    Also turn on variant 1, which has a curved 1.
    Disable contextual alternates for now. There is a bug, either in Inter or
    in Chrome (https://crbug.com/1046095) that causes colons after a <strong> to
    be raised above the baseline.
    */
    font-feature-settings: 'cv01' 1, 'cv08' 1, 'calt' 0;

    font-size: 16px;
    line-height: 1.7em;
    background-color: #fff;
    height: 100%;
  }
  body {
    height: 100%;
  }
  #content {
    display: grid;
    grid-template-columns: auto 16rem 50rem auto;
    color: #333;
    min-height: 100%;
  }
  #main {
    grid-area: 1 / 3 / 2 / 4;
    padding: 2.2rem;
    padding-left: 4rem;
    padding-right: 4rem;
    overflow: hidden;
  }
  #breadcrumbs {
    margin-bottom: 3rem;
    word-spacing: 0.3em;
    color: #78a;
  }
  #breadcrumbs a {
    word-spacing: 0;
    color: #78a;
  }
  article {
    margin-top: 1.3rem;
  }
  h1, h2, h3 {
    font-weight: 600;
    font-size: 1rem;
    color: #444;
  }
  h1 {
    font-size: 2rem;
    margin-bottom: 2.1rem;
  }
  h2 {
    font-size: 1.42rem;
    margin-top: 3.5rem;
    margin-bottom: 1.6rem;
  }
  h3 {
    margin-bottom: 1.42rem;
  }
  code {
    font-family: 'Roboto Mono', monospace;
    font-size: 0.84rem;
    line-height: 1.5rem;
  }
  h3 > code {
    /* Roboto Mono 500 is about as heavy as Inter semibold (600). */
    font-weight: 500;
  }
  abbr {
    text-transform: uppercase;
    /* Downsize so caps are x-height, and compensate weight loss. */
    font-size: 0.78rem;
    font-weight: 500;
    letter-spacing: 0.05rem;
    /* Prevent abbrs from changing the line height of lines in which they occur. */
    line-height: 0;
  }
  sub, sup {
    /* Don't disturb the line height of normal text. */
    line-height: 0rem;
    font-size: 0.78rem;
    font-weight: 500;
  }
  p > code,
  a > code,
  h3 > code,
  li > code,
  td > code {
    background-color: #f0f0f0;
    padding: 0.13rem;
    padding-left: 0.3rem;
    padding-right: 0.3rem;
    border-radius: 0.2rem;
    line-height: 1rem;
  }
  h3 {
    margin-top: 2.29rem;
    margin-bottom: 0.89rem;
  }
  h3 > code {
    margin-left: -0.1rem;
  }
  a {
    color: #36d;
    text-decoration: none;
  }
  p, ul, ol, pre, table {
    /* Same space as line height, leave exactly one line blank. */
    margin-bottom: 1.7rem;
  }
  pre {
    padding-top: 0.8rem;
    padding-bottom: 0.9rem;
    padding-left: 1.19rem;
    padding-right: 0;
    background-color: #f8f8f8;
    border-radius: 0 0.2rem 0.2rem 0;
    border-left: 0.3rem solid #d5d8e0;
    overflow-x: auto;
  }
  pre > code {
    margin-right: 1.41rem;
    color: #555;
  }
  ul, ol {
    list-style-type: none;
    counter-reset: item;
  }
  table {
    font-variant-numeric: tabular-nums;
  }
  th, td {
    padding-right: 2rem;
  }
  th {
    text-align: left;
  }
  td > img {
    display: block;
    padding-top: 1em;
    padding-bottom: 1em;
  }
  #main ul li:before {
    color: #555;
    content: '\2022';
    display: inline-block;
    font-weight: 700;
    margin-left: -0.9rem;
    width: 0.9rem;
  }
  #main ul li {
    margin-left: 0.87rem;
  }
  #main ol li:before {
    content: counter(item);
    display: inline-block;
    font-weight: 700;
    width: 0.8rem;
    margin-left: -1.6rem;
    padding-right: 0.8rem;
  }
  #main ol li {
    margin-left: 1.6rem;
    counter-increment: item;
  }
  #nav-prev-next {
    margin-top: 3.4rem;
    padding-bottom: 3.3rem;
  }
  #nav-prev, #nav-next, #repo-link {
    display: inline-block;
  }
  #nav-prev {
    float: left;
  }
  #nav-next, #repo-link {
    float: right;
    text-align: right;
  }
  #nav-prev::before {
    content: '\219e';
    padding-right: 0.5em;
  }
  #nav-next::after {
    content: '\21a0';
    padding-left: 0.5em;
  }
  aside {
    grid-area: 1 / 1 / 2 / 3;
    border-right: 1px solid #eee;
    background-color: #fafafa;
  }
  aside nav {
    margin-top: 9rem;
    padding-bottom: 3.4rem;
    width: 14rem;
    float: right;
    /* Put the active chapter border over the sidebar border. */
    margin-right: -1px;
  }
  aside a {
    color: #78a;
  }
  aside .toc-section {
    font-weight: 700;
  }
  aside ul {
    margin-bottom: 0;
  }
  aside li ul {
    padding-top: 0.6rem;
    padding-bottom: 1.1rem;
  }
  aside li.toc-section {
    padding-top: 1.7rem;
  }
  aside li.toc-section a {
    color: #36d;
  }
  aside li.current, aside li ul {
    border-right: 0.3em solid #d5d8e0;
    padding-left: 1em;
    margin-left: -1em;
  }
  aside .current a {
    font-weight: 600;
  }
  aside li.toc-heading {
    padding-left: 1em;
  }

  @media(max-width: 63rem)
  {
    #content {
      /* Manual implementation of max-width: on narrower viewports,
         auto-size the body. */
      grid-template-columns: 0 16rem auto 0;
    }
  }

  @media(max-width: 1150px)
  {
    html { font-size: 15px; }
  }

  /* Move the sidebar TOC below content at small widths. */
  @media(max-width: 800px)
  {
    #content {
      display: block;
    }
    aside {
      border-top: 1px solid #eee;
      border-right: 0px none;
    }
    aside nav {
      margin-left: 4em;
      margin-top: 1.7em;
      float: none;
    }
    #main {
      padding-bottom: 1.7em;
    }
    aside li.current, aside li ul {
      border-right: 0px none;
    }
  }

  /* Use less generous margins for very narrow viewports. */
  @media(max-width: 650px)
  {
    #main {
      padding-left: 2rem;
      padding-right: 2rem;
    }
    aside nav {
      margin-left: 2rem;
      padding-bottom: 2rem;
    }
  }

  @media(max-width: 450px)
  {
    #main {
      padding-left: 1.7em;
      padding-right: 1.7em;
    }
    aside nav {
      margin-left: 1.7em;
    }
  }
  </style>
</head>
<body>
  <div id="content">
    <div id="main">
      <nav id="breadcrumbs">
        <a href="..">Pris</a>
        › <a href="..">User Guide</a>
  › <a href="./">The language</a>
  <a id="repo-link" href="https://github.com/ruuda/pris/">GitHub</a>
      </nav>
      <article>
        <h1 id="the-language">The language</h1>
<p>This chapter characterizes the Pris domain specific language in various ways. It
may help to determine where Pris is positioned relative to other languages. If
you want to get your hands dirty, the <a href="https://github.com/ruuda/pris/tree/master/examples">examples</a> may be a better way
to get started.</p>
<h2 id="paradigm">Paradigm</h2>
<p><strong>Pris is purely functional</strong>, in the following sense:</p>
<ul>
<li>Pris has first-class functions: functions can be passed around as values.</li>
<li>Functions in Pris are pure: they have no side effects.</li>
<li>Values in Pris are immutable, there are no mutable objects.</li>
</ul>
<p><strong>Pris is imperative</strong>,
in the sense that blocks consist of statements that are executed sequentially.
A statement is either assignment to a variable, a <code>put</code> statement that places
a frame, or a <code>return</code> from a block. Although assignments mutate the bindings
in the current scope, and <code>put</code> statements mutate the current frame, these
mutations are only visible to the current block, and do not affect the
surrounding scope.</p>
<pre><code>x = 1
y =
{
  x = 2
  return x
}
// At this point, x = 1 and y = 2.
</code></pre>
<p><strong>Pris is dynamically scoped</strong>,
in the sense that the variables that are in scope when a function is evaluated,
depend on the call site, not on the site where the function was defined. When
used carelessly, this can make make programs intractable quickly.  But when used
with care, dynamic scoping is a powerful tool for a graphics language,
reminiscent of the cascading properties of <abbr>CSS</abbr>. For example, we
can write a <code>title</code> function that makes no particular choice of color, so the
surrounding scope can control the color.</p>
<pre><code>title = function(text)
{
    font_size = 0.2h
    text_align = "center"
    put t(title) at (0.5w, 0.5h)
}

{
  // This title will be red.
  color = #ff0000
  put title("Slide 1")
}

{
  // This title will be blue.
  color = #0000ff
  put title("Slide 2")
}
</code></pre>
<p>Due to dynamic scoping, there are two ways to provide a value to a function:</p>
<ul>
<li>By setting a particular variable in the calling scope.</li>
<li>By passing the value as a function argument.</li>
</ul>
<p>Variables are useful for values that do not change often, to avoid having to
pass them all the time. For example, the <a href="../reference/t/"><code>t</code></a> function uses
the <code>font_family</code> and <code>font_style</code> from the surrounding scope, but accepts the
text as argument.</p>
<h2 id="type-system">Type system</h2>
<p><strong>Pris is strongly typed</strong>,
in the sense that it reports a type error for nonsensical operations,
rather than implicitly coercing values.
Number types have units:
a length is different from a dimensionless number.</p>
<p><strong>Pris is dynamically typed</strong>,
in the sense that type errors in unreachable code
do not cause compilation to fail.</p>
<pre><code>// Calling this function will trigger a type error,
// but defining it does not.
trigger_error = function()
{
  return "wrong" + 0
}
</code></pre>
<p>Dynamic typing is not a deep design choice, it is simply easier to implement.
Pris may acquire static type checking in the future.</p>
<h2 id="semantics">Semantics</h2>
<p><strong>Evaluation in Pris is strict</strong>.
Function arguments are reduced to values before evaluating the function body,
and the right-hand side of an assignment is evaluated fully before continuing to
the next statement.</p>
<p><strong>Suffixes are resolved eagerly</strong>.
Relative lengths are converted into absolute lengths as soon as they are
evaluated, and the conversion depends on the meaning of the suffix at that time.
Arithmetic with lenghts does <em>not</em> operate on symbolic suffixes.</p>
<pre><code>font_size = 0.1h
x = 1em
// At this point, x = 0.1h.

font_size = 0.2h
// At this point, x = 0.1h still.
</code></pre>
<h2 id="syntax">Syntax</h2>
<p><strong>Pris is whitespace-insensitive</strong>.
Whitespace separates tokens, but the amount, and the distinction between spaces
and newlines, are irrelevant. Tabs and carriage returns are rejected by the
parser.</p>
<p><strong>Pris does not have a statement separator</strong>.
Rather, the grammar is constructed in such a way that statement boundaries are
unambiguous.</p>
<pre><code>// You can put multiple statements on a line.
// That doesn't mean it's a good idea though.
x = 10 y = 12 put t("12") z = 1 + 2 w = z
</code></pre>
      </article>
      <nav id="nav-prev-next">
        <a id="nav-prev" href="../building/" title="Building">Previous</a>
        <a id="nav-next" href="../reference/at/" title="at">Next</a>
        </nav>
      </div>
    <aside>
      <nav>
        <ul>
        <li class="toc-section"><a href="..">Overview</a></li>
          <li class="toc-section"><a href="../getting-started/">User Guide</a></li>
          <li class="toc-chapter
              "><a href="../getting-started/">Getting started</a></li>
            <li class="toc-chapter
              "><a href="../building/">Building</a></li>
            <li class="toc-chapter
               current"><a href="./">The language</a></li>
            <li><ul>
                <li class="toc-heading"><a href="#paradigm">Paradigm</a></li>
                <li class="toc-heading"><a href="#type-system">Type system</a></li>
                <li class="toc-heading"><a href="#semantics">Semantics</a></li>
                <li class="toc-heading"><a href="#syntax">Syntax</a></li>
                </ul></li>
               <li class="toc-section"><a href="https://github.com/ruuda/pris/tree/master/examples">Examples</a></li>
          <li class="toc-section"><a href="../reference/at/">Reference</a></li>
          <li class="toc-chapter
              "><a href="../reference/at/">at</a></li>
            <li class="toc-chapter
              "><a href="../reference/canvas_size/">canvas_size</a></li>
            <li class="toc-chapter
              "><a href="../reference/fill_circle/">fill_circle</a></li>
            <li class="toc-chapter
              "><a href="../reference/fill_polygon/">fill_polygon</a></li>
            <li class="toc-chapter
              "><a href="../reference/fill_rectangle/">fill_rectangle</a></li>
            <li class="toc-chapter
              "><a href="../reference/fit/">fit</a></li>
            <li class="toc-chapter
              "><a href="../reference/glyph/">glyph</a></li>
            <li class="toc-chapter
              "><a href="../reference/hyperlink/">hyperlink</a></li>
            <li class="toc-chapter
              "><a href="../reference/image/">image</a></li>
            <li class="toc-chapter
              "><a href="../reference/line/">line</a></li>
            <li class="toc-chapter
              "><a href="../reference/sqrt/">sqrt</a></li>
            <li class="toc-chapter
              "><a href="../reference/str/">str</a></li>
            <li class="toc-chapter
              "><a href="../reference/t/">t</a></li>
            <li class="toc-section"><a href="../background/">About</a></li>
          <li class="toc-chapter
              "><a href="../background/">Background</a></li>
            <li class="toc-chapter
              "><a href="../name/">Name</a></li>
            <li class="toc-section"><a href="../parser/">Internals</a></li>
          <li class="toc-chapter
              "><a href="../parser/">Parser</a></li>
            <li class="toc-chapter
              "><a href="../subframes/">Subframes</a></li>
            </ul>
      </nav>
    </aside>
  </div>
</body>
</html>